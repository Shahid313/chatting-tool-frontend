{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Shahid Khan\\\\Downloads\\\\chating_tool\\\\src\\\\pages\\\\main\\\\channels\\\\chat.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport './chat.css';\nimport Axios from 'axios';\nimport Message from \"../../../components/message\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { GETMESSAGESDATA } from '../../../redux/actions';\nimport { BrowserRouter as Router, Routes as Switch, Route, Link, redirect, useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst storage = localStorage.getItem('userInfo');\nconst parse = JSON.parse(storage);\nconst user_id = window.location.pathname.split(\"/\")[2];\nexport default function Chat() {\n  _s();\n  const dispatch = useDispatch();\n  const data = useSelector(state => state.messagesData.data);\n  const messagesEndRef = useRef();\n  const [message, setMessage] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(true);\n  let navigate = useNavigate();\n  const getMessagesData = receiver_id => {\n    console.log(receiver_id);\n    try {\n      return dispatch => {\n        Axios.get(`http://localhost:5000/message/previewMessages?sender_id=${parse.id}&&receiver_id=${receiver_id}`).then(res => {\n          dispatch({\n            type: GETMESSAGESDATA,\n            payload: res.data.messages\n          });\n          setIsLoading(false);\n        }).catch(err => {\n          console.log(\"Something Went Wrong\");\n          console.log(err);\n          setIsLoading(false);\n        });\n      };\n    } catch (error) {\n      // Add custom logic to handle errors\n      console.log(\"error world\");\n      console.log(error);\n    }\n  };\n  const sendMessage = () => {\n    if (message.length < 1) {\n      return;\n    }\n    const data = new FormData();\n    data.append(\"content\", message);\n    data.append(\"sender_id\", parse.id);\n    data.append(\"receiver_id\", user_id);\n    Axios.post('http://localhost:5000/message/send', data).then(res => {\n      if (res.data.msg == \"Message sent successfully\") {\n        fetchData();\n      }\n    });\n  };\n  const is_loggedin = () => {\n    if (!localStorage.getItem('userInfo')) {\n      navigate('/signin');\n    }\n  };\n  const fetchData = id => dispatch(getMessagesData(id));\n  useEffect(() => {\n    fetchData(user_id);\n    is_loggedin();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat_window\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        style: {\n          textDecoration: 'none',\n          padding: 5\n        },\n        to: \"/home\",\n        children: \"Back to home\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"top_menu\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"title\",\n          children: \"Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"messages\",\n        ref: messagesEndRef,\n        children: isLoading == false ? data.map(message => /*#__PURE__*/_jsxDEV(Message, {\n          message: message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this)) : /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Loading ...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 14\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bottom_wrapper clearfix\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message_input_wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            onChange: val => setMessage(val.target.value),\n            className: \"message_input\",\n            placeholder: \"Type your message here...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: () => sendMessage(),\n          className: \"send_message\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text\",\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n_s(Chat, \"C7XT/0W8idUiej6YXCTDvX6/o8Q=\", false, function () {\n  return [useDispatch, useSelector, useNavigate];\n});\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Axios","Message","useDispatch","useSelector","GETMESSAGESDATA","BrowserRouter","Router","Routes","Switch","Route","Link","redirect","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","storage","localStorage","getItem","parse","JSON","user_id","window","location","pathname","split","Chat","_s","dispatch","data","state","messagesData","messagesEndRef","message","setMessage","isLoading","setIsLoading","navigate","getMessagesData","receiver_id","console","log","get","id","then","res","type","payload","messages","catch","err","error","sendMessage","length","FormData","append","post","msg","fetchData","is_loggedin","children","className","style","textDecoration","padding","to","fileName","_jsxFileName","lineNumber","columnNumber","ref","map","onChange","val","target","value","placeholder","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Shahid Khan/Downloads/chating_tool/src/pages/main/channels/chat.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport './chat.css'\nimport Axios from 'axios'\nimport Message from \"../../../components/message\";\nimport {useDispatch, useSelector} from 'react-redux';\nimport { GETMESSAGESDATA } from '../../../redux/actions';\nimport {\n  BrowserRouter as Router,\n  Routes as Switch,\n  Route,\n  Link,\n  redirect,\n  useNavigate\n} from \"react-router-dom\";\n\n\nconst storage = localStorage.getItem('userInfo')\nconst parse = JSON.parse(storage)\nconst user_id = window.location.pathname.split(\"/\")[2]\n\n\nexport default function Chat(){\n  const dispatch = useDispatch()\n  const data = useSelector(state => state.messagesData.data);\n  \n  const messagesEndRef =useRef()\n   const [message,setMessage] = useState(\"\")\n   const [isLoading,setIsLoading] = useState(true)\n   let navigate = useNavigate()\n\n\n\n   const getMessagesData = (receiver_id) => {\n    console.log(receiver_id)\n    try {\n      return dispatch => {\n        \n       Axios.get(`http://localhost:5000/message/previewMessages?sender_id=${parse.id}&&receiver_id=${receiver_id}`).then(res=>{\n          dispatch({\n            type: GETMESSAGESDATA,\n            payload: res.data.messages\n          });\n          setIsLoading(false)\n        })\n        .catch(err=>{\n          console.log(\"Something Went Wrong\")\n          console.log(err)\n          setIsLoading(false)\n\n        })\n       \n      };\n    } catch (error) {\n      // Add custom logic to handle errors\n      console.log(\"error world\")\n      \n      console.log(error);\n    }\n  }\n\n\n\n   const sendMessage = () => {\n    if(message.length<1){\n      return\n    }\n\n    const data = new FormData()\n    data.append(\"content\", message)\n    data.append(\"sender_id\", parse.id)\n    data.append(\"receiver_id\", user_id)\n\n    Axios.post('http://localhost:5000/message/send', data).then((res) => {\n      if(res.data.msg == \"Message sent successfully\"){\n        fetchData()\n      } \n    })\n    \n\n   }\n \n  \n  \n   const is_loggedin = ()=>{\n    if(!localStorage.getItem('userInfo')){\n      navigate('/signin')\n\n    }\n    }\n\n    const fetchData = (id)=> dispatch(getMessagesData(id)) \n\n   useEffect(()=>{\n    \n    fetchData(user_id)\n    is_loggedin()\n    \n   },[])\n\n  \n \n        return <>\n\n        <div className=\"chat_window\" >\n          <Link style={{textDecoration:'none', padding:5}} to=\"/home\">Back to home</Link>\n        \n          <div className=\"top_menu\" >\n\n\n         \n            <div className=\"title\">Chat</div>\n          </div>\n          <ul className=\"messages\" ref={messagesEndRef}>\n          \n          {isLoading == false?data.map((message) => (\n            <Message message={message}/>\n          )):<h1>Loading ...</h1>}\n          \n\n      \n\n\n       \n\n            </ul>\n          <div className=\"bottom_wrapper clearfix\">\n            <div className=\"message_input_wrapper\">\n              <input\n                onChange={(val)=>setMessage(val.target.value)}\n                className=\"message_input\"\n                placeholder=\"Type your message here...\"\n              />\n            </div>\n            <div onClick={() => sendMessage()}  className=\"send_message\">\n              <div className=\"icon\" />\n              <div className=\"text\">Send</div>\n            </div>\n          </div>\n        </div>\n       \n\n\n     \n \n      </>\n      \n    }\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAC1D,OAAO,YAAY;AACnB,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,OAAO,MAAM,6BAA6B;AACjD,SAAQC,WAAW,EAAEC,WAAW,QAAO,aAAa;AACpD,SAASC,eAAe,QAAQ,wBAAwB;AACxD,SACEC,aAAa,IAAIC,MAAM,EACvBC,MAAM,IAAIC,MAAM,EAChBC,KAAK,EACLC,IAAI,EACJC,QAAQ,EACRC,WAAW,QACN,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAG1B,MAAMC,OAAO,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;AAChD,MAAMC,KAAK,GAAGC,IAAI,CAACD,KAAK,CAACH,OAAO,CAAC;AACjC,MAAMK,OAAO,GAAGC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AAGtD,eAAe,SAASC,IAAIA,CAAA,EAAE;EAAAC,EAAA;EAC5B,MAAMC,QAAQ,GAAG3B,WAAW,EAAE;EAC9B,MAAM4B,IAAI,GAAG3B,WAAW,CAAC4B,KAAK,IAAIA,KAAK,CAACC,YAAY,CAACF,IAAI,CAAC;EAE1D,MAAMG,cAAc,GAAEnC,MAAM,EAAE;EAC7B,MAAM,CAACoC,OAAO,EAACC,UAAU,CAAC,GAAGpC,QAAQ,CAAC,EAAE,CAAC;EACzC,MAAM,CAACqC,SAAS,EAACC,YAAY,CAAC,GAAGtC,QAAQ,CAAC,IAAI,CAAC;EAC/C,IAAIuC,QAAQ,GAAG1B,WAAW,EAAE;EAI5B,MAAM2B,eAAe,GAAIC,WAAW,IAAK;IACxCC,OAAO,CAACC,GAAG,CAACF,WAAW,CAAC;IACxB,IAAI;MACF,OAAOX,QAAQ,IAAI;QAElB7B,KAAK,CAAC2C,GAAG,CAAE,2DAA0DvB,KAAK,CAACwB,EAAG,iBAAgBJ,WAAY,EAAC,CAAC,CAACK,IAAI,CAACC,GAAG,IAAE;UACpHjB,QAAQ,CAAC;YACPkB,IAAI,EAAE3C,eAAe;YACrB4C,OAAO,EAAEF,GAAG,CAAChB,IAAI,CAACmB;UACpB,CAAC,CAAC;UACFZ,YAAY,CAAC,KAAK,CAAC;QACrB,CAAC,CAAC,CACDa,KAAK,CAACC,GAAG,IAAE;UACVV,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;UACnCD,OAAO,CAACC,GAAG,CAACS,GAAG,CAAC;UAChBd,YAAY,CAAC,KAAK,CAAC;QAErB,CAAC,CAAC;MAEJ,CAAC;IACH,CAAC,CAAC,OAAOe,KAAK,EAAE;MACd;MACAX,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;MAE1BD,OAAO,CAACC,GAAG,CAACU,KAAK,CAAC;IACpB;EACF,CAAC;EAIA,MAAMC,WAAW,GAAGA,CAAA,KAAM;IACzB,IAAGnB,OAAO,CAACoB,MAAM,GAAC,CAAC,EAAC;MAClB;IACF;IAEA,MAAMxB,IAAI,GAAG,IAAIyB,QAAQ,EAAE;IAC3BzB,IAAI,CAAC0B,MAAM,CAAC,SAAS,EAAEtB,OAAO,CAAC;IAC/BJ,IAAI,CAAC0B,MAAM,CAAC,WAAW,EAAEpC,KAAK,CAACwB,EAAE,CAAC;IAClCd,IAAI,CAAC0B,MAAM,CAAC,aAAa,EAAElC,OAAO,CAAC;IAEnCtB,KAAK,CAACyD,IAAI,CAAC,oCAAoC,EAAE3B,IAAI,CAAC,CAACe,IAAI,CAAEC,GAAG,IAAK;MACnE,IAAGA,GAAG,CAAChB,IAAI,CAAC4B,GAAG,IAAI,2BAA2B,EAAC;QAC7CC,SAAS,EAAE;MACb;IACF,CAAC,CAAC;EAGH,CAAC;EAID,MAAMC,WAAW,GAAGA,CAAA,KAAI;IACvB,IAAG,CAAC1C,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,EAAC;MACnCmB,QAAQ,CAAC,SAAS,CAAC;IAErB;EACA,CAAC;EAED,MAAMqB,SAAS,GAAIf,EAAE,IAAIf,QAAQ,CAACU,eAAe,CAACK,EAAE,CAAC,CAAC;EAEvD/C,SAAS,CAAC,MAAI;IAEb8D,SAAS,CAACrC,OAAO,CAAC;IAClBsC,WAAW,EAAE;EAEd,CAAC,EAAC,EAAE,CAAC;EAIA,oBAAO9C,OAAA,CAAAE,SAAA;IAAA6C,QAAA,eAEP/C,OAAA;MAAKgD,SAAS,EAAC,aAAa;MAAAD,QAAA,gBAC1B/C,OAAA,CAACJ,IAAI;QAACqD,KAAK,EAAE;UAACC,cAAc,EAAC,MAAM;UAAEC,OAAO,EAAC;QAAC,CAAE;QAACC,EAAE,EAAC,OAAO;QAAAL,QAAA,EAAC;MAAY;QAAAM,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAAO,eAE/ExD,OAAA;QAAKgD,SAAS,EAAC,UAAU;QAAAD,QAAA,eAIvB/C,OAAA;UAAKgD,SAAS,EAAC,OAAO;UAAAD,QAAA,EAAC;QAAI;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAM;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAC7B,eACNxD,OAAA;QAAIgD,SAAS,EAAC,UAAU;QAACS,GAAG,EAAEtC,cAAe;QAAA4B,QAAA,EAE5CzB,SAAS,IAAI,KAAK,GAACN,IAAI,CAAC0C,GAAG,CAAEtC,OAAO,iBACnCpB,OAAA,CAACb,OAAO;UAACiC,OAAO,EAAEA;QAAQ;UAAAiC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,QAC3B,CAAC,gBAACxD,OAAA;UAAA+C,QAAA,EAAI;QAAW;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAK;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAQhB,eACPxD,OAAA;QAAKgD,SAAS,EAAC,yBAAyB;QAAAD,QAAA,gBACtC/C,OAAA;UAAKgD,SAAS,EAAC,uBAAuB;UAAAD,QAAA,eACpC/C,OAAA;YACE2D,QAAQ,EAAGC,GAAG,IAAGvC,UAAU,CAACuC,GAAG,CAACC,MAAM,CAACC,KAAK,CAAE;YAC9Cd,SAAS,EAAC,eAAe;YACzBe,WAAW,EAAC;UAA2B;YAAAV,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA;QACvC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,QACE,eACNxD,OAAA;UAAKgE,OAAO,EAAEA,CAAA,KAAMzB,WAAW,EAAG;UAAES,SAAS,EAAC,cAAc;UAAAD,QAAA,gBAC1D/C,OAAA;YAAKgD,SAAS,EAAC;UAAM;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,QAAG,eACxBxD,OAAA;YAAKgD,SAAS,EAAC,MAAM;YAAAD,QAAA,EAAC;UAAI;YAAAM,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,QAAM;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,QAC5B;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QACF;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EACF,iBAML;AAEL;AAAC1C,EAAA,CA7HmBD,IAAI;EAAA,QACTzB,WAAW,EACfC,WAAW,EAKRS,WAAW;AAAA;AAAAmE,EAAA,GAPLpD,IAAI;AAAA,IAAAoD,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}